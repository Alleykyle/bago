{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <title>Folders</title>
  <link rel="stylesheet" href="{% static 'CSS/dashboard.css' %}">
  <link rel="stylesheet" href="{% static 'CSS/folder.css' %}">
  <link rel="stylesheet" href="{% static 'CSS/theme-system.css' %}">
</head>
<body>
  <div class="dashboard-container">
    <!-- Sidebar -->
    <div class="sidebar">
      <img src="{% static 'Pictures/logo1.png' %}" alt="DILG Logo" class="logo">
      <ul class="nav-menu">
        <li><a href="/dashboard/">Dashboard</a></li>
        <li><a href="/application_request/">Application Request</a></li>
        <li><a href="/history/">History</a></li>
        <li><a href="/employees_profile/">Employees Profile</a></li>
        <li><a href="/folder/">Folders</a></li>
        <li><a href="/settings/">Settings</a></li>
      </ul>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <!-- Header -->
      <div class="header">
        <h1>Folder Management</h1>
        <a href="/dashboard/" class="back-button">‚Üê Back</a>
      </div>
      
      <!-- Action Buttons with Search -->
      <div class="action-buttons">
        <div class="buttons-left">
          <button class="create-button">
            <i class="fas fa-plus"></i> Create
          </button>
          <button class="upload-button">
            <i class="fas fa-upload"></i> Upload
          </button>
        </div>
        <div class="search-container">
          <input type="text" class="search-bar" placeholder="Search">
        </div>
      </div>
      
      <!-- Folder Cards -->
      <div class="card-grid">
        {% for folder in folders %}
        <div class="profile-card">
          <div class="folder-icon"><i class="fas fa-folder"></i></div>
          <h3>{{ folder.name }}</h3>
          <p>{{ folder.description }}</p>
        </div>
        {% endfor %}
        
        <div class="profile-card">
          <div class="folder-icon"><i class="fas fa-folder"></i></div>
          <h3>Brgy. Monitoring Files</h3>
          <p>Requirements</p>
          <a href="/monitoring_filess/" class="edit-button">Open</a>
        </div>
        
        <div class="profile-card">
          <div class="folder-icon"><i class="fas fa-folder"></i></div>
          <h3>Certification Files</h3>
          <p>Documents</p>
          <a href="/certification_filess/" class="edit-button">Open</a>
        </div>
        
        
    </div> <!-- This closing div was missing! -->
  </div> <!-- This closes dashboard-container -->
  <script>
 
    // Global Theme Management System
    class GlobalThemeManager {
      constructor() {
        this.currentTheme = 'light';
        this.currentFontSize = 'medium';
        this.currentAnimationSpeed = 'normal';
        this.init();
      }

      init() {
        // Load saved preferences on every page load
        this.loadPreferences();
        // Apply saved theme immediately
        this.applyTheme(this.currentTheme);
        this.applyFontSize(this.currentFontSize);
        this.applyAnimationSpeed(this.currentAnimationSpeed);
        // Listen for system theme changes
        this.watchSystemTheme();
      }

      loadPreferences() {
        this.currentTheme = localStorage.getItem('theme') || 'light';
        this.currentFontSize = localStorage.getItem('fontSize') || 'medium';
        this.currentAnimationSpeed = localStorage.getItem('animationSpeed') || 'normal';
      }

      applyTheme(theme) {
        const html = document.documentElement;
        
        // Add transition class for smooth theme switching
        html.classList.add('theme-transition');
        
        // Set theme attribute
        html.setAttribute('data-theme', theme);
        
        // Store current theme
        this.currentTheme = theme;
        localStorage.setItem('theme', theme);

        // Remove transition class after animation
        setTimeout(() => {
          html.classList.remove('theme-transition');
        }, 300);

        // Update theme selector if it exists on the page
        const themeSelector = document.getElementById('change-theme');
        if (themeSelector) {
          themeSelector.value = theme;
        }
      }

      applyFontSize(size) {
        const root = document.documentElement;
        const sizeMap = {
          'small': '14px',
          'medium': '15px',
          'large': '16px'
        };
        
        
        root.style.fontSize = sizeMap[size];
        this.currentFontSize = size;
        localStorage.setItem('fontSize', size);

        // Update font size selector if it exists
        const fontSizeSelector = document.getElementById('font-size');
        if (fontSizeSelector) {
          fontSizeSelector.value = size;
        }
      }

      applyAnimationSpeed(speed) {
        const root = document.documentElement;
        const speedMap = {
          'slow': '0.6s',
          'normal': '0.3s',
          'fast': '0.15s',
          'none': '0s'
        };
        
        root.style.setProperty('--transition-duration', speedMap[speed]);
        this.currentAnimationSpeed = speed;
        localStorage.setItem('animationSpeed', speed);

        // Update all transition durations
        const style = document.createElement('style');
        style.textContent = `
          .theme-transition * {
            transition-duration: ${speedMap[speed]} !important;
          }
        `;
        
        // Remove previous speed style if exists
        const oldStyle = document.getElementById('animation-speed-style');
        if (oldStyle) oldStyle.remove();
        
        style.id = 'animation-speed-style';
        document.head.appendChild(style);

        // Update animation speed selector if it exists
        const animationSpeedSelector = document.getElementById('animation-speed');
        if (animationSpeedSelector) {
          animationSpeedSelector.value = speed;
        }
      }

      watchSystemTheme() {
        if (window.matchMedia) {
          const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
          mediaQuery.addListener((e) => {
            if (this.currentTheme === 'auto') {
              // Force re-application of auto theme
              this.applyTheme('auto');
            }
          });
        }
      }

      // Method to change theme programmatically
      setTheme(theme) {
        this.applyTheme(theme);
      }

      // Method to get current theme
      getTheme() {
        return this.currentTheme;
      }

      // Method to toggle between light and dark
      toggleTheme() {
        const newTheme = this.currentTheme === 'light' ? 'dark' : 'light';
        this.applyTheme(newTheme);
        return newTheme;
      }

      showSuccessMessage(message) {
        // Remove existing message if any
        const existing = document.querySelector('.success-message');
        if (existing) existing.remove();

        // Create new message
        const messageEl = document.createElement('div');
        messageEl.className = 'success-message';
        messageEl.textContent = message;
        document.body.appendChild(messageEl);

        // Show message
        setTimeout(() => messageEl.classList.add('show'), 100);

        // Hide and remove message
        setTimeout(() => {
          messageEl.classList.remove('show');
          setTimeout(() => messageEl.remove(), 300);
        }, 3000);
      }
    }

    // Initialize global theme manager
    let globalThemeManager;

    // Initialize when DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
      globalThemeManager = new GlobalThemeManager();
      
      // Add event listeners if theme controls exist on current page
      const themeSelector = document.getElementById('change-theme');
      if (themeSelector) {
        themeSelector.addEventListener('change', function(e) {
          globalThemeManager.setTheme(e.target.value);
        });
      }

      const fontSizeSelector = document.getElementById('font-size');
      if (fontSizeSelector) {
        fontSizeSelector.addEventListener('change', function(e) {
          globalThemeManager.applyFontSize(e.target.value);
        });
      }

      const animationSpeedSelector = document.getElementById('animation-speed');
      if (animationSpeedSelector) {
        animationSpeedSelector.addEventListener('change', function(e) {
          globalThemeManager.applyAnimationSpeed(e.target.value);
        });
      }
    });

    // Make theme manager globally accessible
    window.globalThemeManager = globalThemeManager;

    // Global functions
    function toggleTheme() {
      if (window.globalThemeManager) {
        return window.globalThemeManager.toggleTheme();
      }
    }
  </script>
</body>
</html>